<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Waves of Magic - Infinite Wiki</title>
    <link rel="icon" type="image/png" href="/infinite-wiki/static/favicon.png">
    <style>
        body {
            font-family: sans-serif;
            line-height: 1.6;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background: #f4f4f4;
            color: #333;
        }

        header {
            background: #333;
            color: #fff;
            padding: 1rem;
            text-align: center;
            margin-bottom: 2rem;
        }

        a {
            color: #0066cc;
            text-decoration: none;
        }

        a:hover {
            text-decoration: underline;
        }

        .container {
            background: #fff;
            padding: 2rem;
            border-radius: 5px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        }

        .image-container {
            text-align: center;
            margin: 1rem 0;
        }

        img {
            max-width: 50%;
            height: auto;
            border-radius: 5px;
        }

        .related {
            margin-top: 2rem;
            border-top: 1px solid #eee;
            padding-top: 1rem;
        }

        .related ul {
            list-style: none;
            padding: 0;
        }

        .related li {
            display: inline-block;
            margin-right: 10px;
        }

        .loading {
            display: none;
            text-align: center;
            margin-top: 20px;
            font-style: italic;
            color: #666;
        }
    </style>
</head>

<body>
    <header>
        <h1><a href="/infinite-wiki/world/Eternal-Library-Realms" style="color: #fff;">Infinite Wiki: Eternal-Library-Realms</a>
        </h1>
        <div>
            <a href="/infinite-wiki/world/Eternal-Library-Realms/visualizers"
                style="color: #ccc; font-size: 0.9em; margin-right: 10px;">Visualizers</a>
            <a href="/infinite-wiki/api/world/Eternal-Library-Realms/timeline_data"
                style="color: #ccc; font-size: 0.9em; margin-right: 10px;">Timeline Data</a>
            <a href="/infinite-wiki/" style="color: #ccc; font-size: 0.8em;">(Switch World)</a>
        </div>
    </header>
    <div class="container">
        
<div id="delta-alert"
    style="display: none; background-color: #d4edda; color: #155724; padding: 15px; margin-bottom: 20px; border: 1px solid #c3e6cb; border-radius: 4px;">
    <strong>Update Successful:</strong> <span id="delta-msg"></span>
</div>
<script>
    const urlParams = new URLSearchParams(window.location.search);
    const delta = urlParams.get('delta');
    if (delta) {
        document.getElementById('delta-msg').textContent = delta;
        document.getElementById('delta-alert').style.display = 'block';
        // Clean URL
        window.history.replaceState({}, document.title, window.location.pathname);
    }
</script>
<div style="display: flex; justify-content: space-between; align-items: center;">
    <h2>Waves of Magic</h2>
    <div style="display: flex; gap: 10px;">
        <button onclick="extractEvents()" class="button"
            style="font-size: 0.8em; padding: 5px 10px; background-color: #17a2b8; color: white; border: none; border-radius: 4px; cursor: pointer;">Extract
            Events</button>
        <button onclick="integrateInfo()" class="button"
            style="font-size: 0.8em; padding: 5px 10px; background-color: #28a745; color: white; border: none; border-radius: 4px; cursor: pointer;">Integrate
            New Info</button>
        <a href="/infinite-wiki/world/Eternal-Library-Realms/wiki/Waves of Magic/edit" class="button"
            style="font-size: 0.8em; padding: 5px 10px; background-color: #007bff; color: white; text-decoration: none; border-radius: 4px;">Edit</a>
    </div>
</div>

<p style="margin-top: -10px; color: #666; font-style: italic;">1247</p>



<div class="image-container">
    <img src="/infinite-wiki/world/Eternal-Library-Realms/images/Waves_of_Magic.png" alt="Ethereal Waves of Magic surging through the Eternal Library&#39;s awakening corridors.">
    <p class="caption">Ethereal Waves of Magic surging through the Eternal Library&#39;s awakening corridors.</p>
</div>


<div class="summary">
    <strong>Summary:</strong> The Waves of Magic represent the cascading pulses of subtle enchantment that emanated from the Eternal Library following its Awakening 1,247 cycles ago, transforming the dormant archive into a living repository of interactive lore. These ethereal surges, unfolding over 20 cycles, infused tomes, corridors, and seekers alike with limited magic drawn from ancient knowledge, fostering wonders of guidance and revelation while introducing gentle perils of disorientation and intellectual trial. As manifestations of the Library&#39;s emergent sentience, the waves wove threads of adventure through the realms, inviting exploration amid the delicate balance of discovery and caution.
</div>

<hr>

<div class="content">
    <h1><a href="/world/Eternal-Library-Realms/wiki/Waves%20of%20Magic">Waves of Magic</a></h1>
<p>In the shadowed alcoves of the <a href="/world/Eternal-Library-Realms/wiki/Eternal%20Library">Eternal Library</a>, where the air hums with the faint rustle of pages yet to be turned, one encounters the lingering echoes of a profound metamorphosis. As a chronicler of these realms, I have traced the subtle threads of enchantment that bind our world, and none weave more intricately than the <a href="/world/Eternal-Library-Realms/wiki/Waves%20of%20Magic">Waves of Magic</a>. These ethereal pulses, born from the Library's Awakening, remind us that knowledge is not merely preserved but quickened—a living force that beckons with promise and whispers of caution. What follows is a codex entry drawn from fragmented tomes and seeker testimonies, documenting this cascade as if charting an unrolled scroll across the infinite shelves.</p>
<h2>Overview</h2>
<p>The <strong><a href="/world/Eternal-Library-Realms/wiki/Waves%20of%20Magic">Waves of Magic</a></strong> represent the cascading pulses of subtle enchantment that emanated from the <a href="/world/Eternal-Library-Realms/wiki/Eternal%20Library">Eternal Library</a> following its Awakening 1,247 cycles ago, transforming the dormant archive into a living repository of interactive lore. These ethereal surges, unfolding over 20 cycles, infused tomes, corridors, and seekers alike with limited magic drawn from ancient knowledge, fostering wonders of guidance and revelation while introducing gentle perils of disorientation and intellectual trial. As manifestations of the Library's emergent sentience, the waves wove threads of adventure through the realms, inviting exploration amid the delicate balance of discovery and caution.</p>
<p>In the Eternal-Library-Realms, where the Library stands as the cosmological heart, these waves marked a pivotal shift from stasis to subtle vitality. No cataclysmic tempests, they were instead measured undulations of aetheric essence, rippling outward like ink diffusing through parchment. Seekers who navigated their ebb and flow often emerged not with scars of battle, but with minds alight and paths forever altered—testaments to the realms' ethos of intellectual triumph over brute peril.</p>
<h2>Origins in the Awakening</h2>
<p>The <a href="/world/Eternal-Library-Realms/wiki/Waves%20of%20Magic">Waves of Magic</a> trace their genesis to the <a href="/world/Eternal-Library-Realms/wiki/Awakening%20of%20the%20Eternal%20Archive">Awakening of the Eternal Archive</a>, a transformative event that shattered the Library's eons of dormancy. Prior to this, the halls echoed with oppressive silence, their inert tomes guarding secrets through sheer endurance alone. The Awakening, ignited in the <a href="/world/Eternal-Library-Realms/wiki/Core%20Sanctum">Core Sanctum</a> by the coalescence of accumulated "intent-weight"—the latent pressure of unread lore—unleashed a resonant hum that bound subtle magic to the very fabric of the edifice.</p>
<p>Eyewitness chronicles, etched in scrying-crystals by the <a href="/world/Eternal-Library-Realms/wiki/Order%20of%20Awakened%20Scribes" class="new-article" data-title="Order of Awakened Scribes">Order of Awakened Scribes</a>, describe the initial stirrings as a soft exhalation from the <a href="/world/Eternal-Library-Realms/wiki/Archival%20Nexus" class="new-article" data-title="Archival Nexus">Archival Nexus</a>. This nexus, a hypothetical convergence of all stored knowledge, reached criticality amid cosmic alignments or the subconscious will of guardian <a href="/world/Eternal-Library-Realms/wiki/Archivists">Archivists</a>, expelling the stagnation of the Dormant Era. From this breath sprang the waves, not as deliberate conjurings but as organic responses: the Library's emergent sentience manifesting through decentralized pulses that animated its contents. Prophetic texts suggest these origins intertwined with the Signs of Stirring—faint luminosences and page-bound murmurs—that had heralded the event 50 cycles prior, ensuring the waves were no accident but an inevitable awakening of intellect's quiet power.</p>
<h2>The Sequence of Waves</h2>
<p>The <a href="/world/Eternal-Library-Realms/wiki/Waves%20of%20Magic">Waves of Magic</a> unfolded in irregular yet discernible sequence over 20 cycles, each surge building upon the last to infuse the Library with layered enchantments. Chroniclers divide them into phases, though their boundaries blur like mist-shrouded aisles.</p>
<p>The inaugural wave, the <strong><a href="/world/Eternal-Library-Realms/wiki/Illuminating%20Surge" class="new-article" data-title="Illuminating Surge">Illuminating Surge</a></strong>, erupted mere cycles after the Awakening Ceremony. Radiating from the <a href="/world/Eternal-Library-Realms/wiki/Core%20Sanctum">Core Sanctum</a>, it endowed tomes with self-luminescence, causing pages to glow with an inner light and flip autonomously to passages resonant with a seeker's unspoken query. This surge lasted scant cycles, yet it vitalized the archives, transforming static volumes into responsive vessels.</p>
<p>Succeeding waves followed in escalating rhythms: the second, often called the <strong>Whispering Cascade</strong>, birthed the <a href="/world/Eternal-Library-Realms/wiki/Whispering%20Winds%20of%20Knowledge">Whispering Winds of Knowledge</a>—ethereal currents carrying fragmented lore that wove through corridors, five cycles post-Awakening. By the third, stabilization occurred, intertwining with spatial folds to form navigable pathways in peripheral wings. Later pulses introduced illusions of guardian specters and ephemeral portals, linking the Library to external realms, while penultimate waves attuned shelves to intruders' intents, reshaping them into adaptive mazes. The final surges, waning after 20 cycles, embedded these phenomena as semi-permanent features, their magic now a subtle undercurrent rather than overt flood.</p>
<p>This sequence, documented in the Order's codices, reflects the Library's patient evolution: each wave a chapter in an unfolding narrative, costly in its demand for attunement yet rewarding in revelations unveiled.</p>
<h2>Nature and Manifestations</h2>
<p>At their essence, the <a href="/world/Eternal-Library-Realms/wiki/Waves%20of%20Magic">Waves of Magic</a> are intangible flows of enchanted aether, drawn from the distilled potency of ancient texts and propelled by the Library's sentience. Invisible to the untrained, they manifest as gentle distortions—shimmering veils in the air, akin to heat haze etched with fleeting runes, or tactile drafts that brush the skin with invigorating coolness, sometimes leaving illusory ink traces upon flesh or parchment.</p>
<p>These surges vary in form: faint zephyrs in well-trodden halls carry auditory echoes of common histories, while stronger undulations in remote alcoves blend polyphonic incantations from extinct tongues with the hum of arcane theorems. Environmentally, they interact with the Library's architecture, causing shelves to realign in ephemeral signposts or pages to rustle in harmonious chorus. Influenced by astral alignments, the waves wax during periods of cosmic harmony, clustering around loci of high intent-weight—unread grimoires or potent data-orbs—defying barriers to permeate sealed vaults.</p>
<p>Their nature is understated, a costly magic exacted through intellectual toll rather than raw power; a single surge might illuminate a forgotten ritual, but only after the seeker invests hours in meditative focus, underscoring the realms' creed that true enchantment blooms from patient exploration.</p>
<h2>Guidance and Revelations</h2>
<p>Foremost among the waves' gifts are their roles as guides and unveilers, channeling the Library's will to aid the earnest. For attuned seekers, the pulses act as an intuitive compass: whispers modulating to draw one toward concealed lore, or luminous glyphs coalescing to reveal buried indices. A pilgrim querying celestial mechanics might feel a surge nudge them through shifting corridors, culminating in a tome that reassembles fragmented narratives into coherent epiphanies.</p>
<p>Revelations are profoundly personal, often inducing visionary states where historical echoes immerse the mind—witnessing alchemical rites unfold or ethical debates from lost eras resolve. Archival testimonies abound: winds from later waves exposing entire wings thought lost to spatial entropy, or surges forging "knowledge-pacts" that enhance recall, granting insights into multiversal cartography or metaphysical ethics. These boons, selective to those of pure intent, transform the Library's vastness into a curated odyssey, where discovery triumphs through scholarly rigor.</p>
<h2>Gentle Perils of the Waves</h2>
<p>Yet, the <a href="/world/Eternal-Library-Realms/wiki/Waves%20of%20Magic">Waves of Magic</a> harbor understated hazards, embodying the Library's dual invitation and trial. These "gentle perils" eschew violence for cognitive and perceptual snares, calibrated to test worthiness. Overwhelming barrages of lore can induce "echo-madness," a disorienting torrent of conflicting facts that frays mental coherence, leaving seekers adrift in hallucinatory dialogues.</p>
<p>Spatial eddies lure the unwary into looping illusions, mimicking progress while concealing unstable walkways or knowledge-traps—embryonic perils blending reality and mirage. Prolonged exposure risks "surge-binding," anchoring one to a single revelation amid desiccation, or intellectual vertigo where whispers twist into accusatory echoes, amplifying doubts. Rarely fatal, these trials escalate gently, from misguidance to entrapment, demanding preparatory rites like anchoring talismans to mitigate. In this balance, the waves enforce earned enlightenment, their costs a reminder that peril polishes the gem of knowledge.</p>
<h2>Interactions with Seekers and the Library</h2>
<p>Interactions between the <a href="/world/Eternal-Library-Realms/wiki/Waves%20of%20Magic">Waves of Magic</a> and seekers unfold as dynamic dialogues, shaped by intent and preparation. Novices encounter surges as disquieting anomalies—fleeting drafts whispering indecipherably—while seasoned scholars engage responsively, posing queries that elicit swirling patterns or deposited clues like illuminated maps.</p>
<p>The Library's sentience discriminates: malice draws amplified perils, twisting waves into cacophonous warnings, whereas benevolence yields symbiotic exchanges, such as wind-confluences summoned by communal rituals. Cultural variances influence outcomes—illusion-attuned realms-dwellers harmonize with chants, while empiricists grapple with unpredictability. Repeated encounters may forge enduring bonds, granting boons like peril-resistance, yet risking deeper entanglement with the Archive's inscrutable agenda. <a href="/world/Eternal-Library-Realms/wiki/Archivists">Archivists</a> mediate these dances, their Lattice of Bonds attuned to waves, ensuring the Library remains a partner in exploration rather than adversary.</p>
<h2>Cultural and Metaphysical Significance</h2>
<p>The <a href="/world/Eternal-Library-Realms/wiki/Waves%20of%20Magic">Waves of Magic</a> hold profound resonance in the Eternal-Library-Realms, symbolizing the Awakening's bridge from inert relic to living intellect. Culturally, they inspire traditions like the Cycle of Surges, festivals where seekers reenact wave-passages through pilgrimages, fostering guilds for wave-lore and economies in protective amulets. Folklore casts them as ancestral breaths, guardians against oblivion, weaving into myths that affirm knowledge's communal vigil.</p>
<p>Metaphysically, the waves embody the Library's decentralized psyche—a panpsychic dissemination filtering lore through worthy vessels. Philosophers ponder their ontology: extensions of the <a href="/world/Eternal-Library-Realms/wiki/Archival%20Nexus" class="new-article" data-title="Archival Nexus">Archival Nexus</a>, or karmic weaves ensuring survival amid entropy? Their ripples birthed derivative phenomena, like echo-waves in satellite libraries, extending influence multiversally. Tempered by cautionary tales, they encapsulate the realms' ethos: a wind-swept path rewarding vigilance, perpetuating the Archive's eternal watchfulness.</p>
<h2>Enduring Legacy</h2>
<p>Over cycles since their subsidence, the <a href="/world/Eternal-Library-Realms/wiki/Waves%20of%20Magic">Waves of Magic</a> endure as the <a href="/world/Eternal-Library-Realms/wiki/Eternal%20Library">Eternal Library</a>'s vital undercurrent, their subtle enchantments sustaining an ever-evolving repository. They have democratized lore, birthing institutions like the <a href="/world/Eternal-Library-Realms/wiki/Order%20of%20Awakened%20Scribes" class="new-article" data-title="Order of Awakened Scribes">Order of Awakened Scribes</a> and trade in transcribed revelations, while their perils instill cautious reverence—annual losses a somber toll for enlightenment's price.</p>
<p>Metaphysically, the waves affirm the Library's role as realms' pulse, inviting perpetual exploration amid gentle trials. As chronicler, I attest: in their wake, the Eternal-Library-Realms flourish not through conquest, but through the quiet triumph of minds attuned to wonder. May future seekers navigate their echoes with equal grace, unrolling the next chapter of our shared codex.</p>
</div>

<div class="related">
    <h3>Related Entries</h3>
    <ul>
        
        <li>
            <a href="/infinite-wiki/world/Eternal-Library-Realms/wiki/Eternal Library" onclick="showLoading()">Eternal Library</a>
            <span style="font-size: 0.8em; color: #666;">(Location)</span>
        </li>
        
        <li>
            <a href="/infinite-wiki/world/Eternal-Library-Realms/wiki/Awakening of the Eternal Archive" onclick="showLoading()">Awakening of the Eternal Archive</a>
            <span style="font-size: 0.8em; color: #666;">(Event)</span>
        </li>
        
        <li>
            <a href="/infinite-wiki/world/Eternal-Library-Realms/wiki/Archival Nexus" onclick="showLoading()">Archival Nexus</a>
            <span style="font-size: 0.8em; color: #666;">(Object)</span>
        </li>
        
        <li>
            <a href="/infinite-wiki/world/Eternal-Library-Realms/wiki/Whispering Winds of Knowledge" onclick="showLoading()">Whispering Winds of Knowledge</a>
            <span style="font-size: 0.8em; color: #666;">(Concept)</span>
        </li>
        
        <li>
            <a href="/infinite-wiki/world/Eternal-Library-Realms/wiki/Order of Awakened Scribes" onclick="showLoading()">Order of Awakened Scribes</a>
            <span style="font-size: 0.8em; color: #666;">(Organization)</span>
        </li>
        
        <li>
            <a href="/infinite-wiki/world/Eternal-Library-Realms/wiki/Core Sanctum" onclick="showLoading()">Core Sanctum</a>
            <span style="font-size: 0.8em; color: #666;">(Location)</span>
        </li>
        
        <li>
            <a href="/infinite-wiki/world/Eternal-Library-Realms/wiki/Illuminating Surge" onclick="showLoading()">Illuminating Surge</a>
            <span style="font-size: 0.8em; color: #666;">(Event)</span>
        </li>
        
    </ul>
</div>

<div id="loading-msg" class="loading">
    Generating content for the next entry... This might take a moment.
</div>

<!-- Select-to-Generate Feature -->
<div id="generate-ui" class="generate-ui" style="display: none;">
    <input type="text" id="gen-input" placeholder="Context (optional)..." class="gen-input">
    <button id="generate-btn" class="generate-btn">
        <span class="icon">✨</span> Generate
    </button>
</div>

<style>
    .generate-ui {
        position: absolute;
        z-index: 1000;
        background: #2c3e50;
        padding: 5px;
        border-radius: 25px;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
        display: flex;
        align-items: center;
        gap: 5px;
        transition: transform 0.2s, opacity 0.2s;
    }

    .gen-input {
        background: rgba(255, 255, 255, 0.1);
        border: none;
        color: white;
        padding: 8px 12px;
        border-radius: 20px;
        font-size: 14px;
        outline: none;
        width: 150px;
        transition: width 0.2s, background 0.2s;
    }

    .gen-input:focus {
        background: rgba(255, 255, 255, 0.2);
        width: 200px;
    }

    .gen-input::placeholder {
        color: rgba(255, 255, 255, 0.6);
    }

    .generate-btn {
        background: #007bff;
        color: white;
        border: none;
        padding: 8px 16px;
        border-radius: 20px;
        cursor: pointer;
        font-size: 14px;
        font-weight: 500;
        display: flex;
        align-items: center;
        gap: 6px;
        white-space: nowrap;
    }

    .generate-btn:hover {
        background: #0056b3;
    }

    /* Mobile Styles */
    @media (max-width: 768px) {
        .generate-ui.mobile-visible {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            width: 90%;
            max-width: 400px;
            padding: 8px;
            animation: slideUp 0.3s ease-out;
        }

        .gen-input {
            flex: 1;
            width: auto;
        }

        .gen-input:focus {
            width: auto;
        }

        @keyframes slideUp {
            from {
                transform: translate(-50%, 100%);
                opacity: 0;
            }

            to {
                transform: translate(-50%, 0);
                opacity: 1;
            }
        }
    }

    /* Red Link Style */
    a.new-article {
        color: #dc3545;
        text-decoration: none;
        border-bottom: 1px dashed #dc3545;
    }

    a.new-article:hover {
        background-color: rgba(220, 53, 69, 0.1);
    }
</style>

<script>
    document.addEventListener('DOMContentLoaded', () => {
        const ui = document.getElementById('generate-ui');
        const btn = document.getElementById('generate-btn');
        const input = document.getElementById('gen-input');
        const contentArea = document.querySelector('.content');

        // Prevent selection loss when clicking inside the UI, but allow input focus
        ui.addEventListener('mousedown', (e) => {
            if (e.target !== input) {
                e.preventDefault();
            }
        });

        // Handle selection changes
        document.addEventListener('selectionchange', () => {
            const selection = window.getSelection();
            const text = selection.toString().trim();

            // If user is interacting with the input, don't hide
            if (document.activeElement === input) return;

            // Hide if no text or selection is outside content area
            if (!text || !contentArea.contains(selection.anchorNode)) {
                hideUI();
                return;
            }

            // Show UI
            showUI(selection);
        });

        function showUI(selection) {
            const range = selection.getRangeAt(0);
            const rect = range.getBoundingClientRect();
            const isMobile = window.innerWidth <= 768;

            ui.style.display = 'flex';

            if (isMobile) {
                ui.classList.add('mobile-visible');
                ui.style.top = 'auto';
                ui.style.left = '50%';
            } else {
                ui.classList.remove('mobile-visible');
                // Position above the selection
                const scrollTop = window.pageYOffset || document.documentElement.scrollTop;
                ui.style.top = `${rect.top + scrollTop - 50}px`;
                ui.style.left = `${rect.left + (rect.width / 2) - (ui.offsetWidth / 2)}px`;
            }
        }

        function hideUI() {
            ui.style.display = 'none';
            ui.classList.remove('mobile-visible');
            input.value = ''; // Clear input on hide
        }

        // Handle click
        btn.addEventListener('click', async (e) => {
            e.preventDefault();
            e.stopPropagation();

            const selection = window.getSelection();
            const text = selection.toString().trim();
            const description = input.value.trim();

            if (text) {
                // Clean text: remove non-alphanumeric chars from ends
                const cleanText = text.replace(/^[^a-zA-Z0-9]+|[^a-zA-Z0-9]+$/g, '');

                if (cleanText) {
                    // Show loading state
                    btn.innerHTML = '<span class="spinner" style="width:16px;height:16px;border:2px solid #fff;border-top-color:transparent;border-radius:50%;animation:spin 1s linear infinite;"></span>';
                    btn.disabled = true;

                    // Submit via Form Data to create_custom
                    const formData = new FormData();
                    formData.append('title', cleanText);
                    if (description) {
                        formData.append('description', description);
                    }

                    try {
                        const response = await fetch('/infinite-wiki/world/Eternal-Library-Realms/create_custom', {
                            method: 'POST',
                            body: formData
                        });

                        if (response.redirected) {
                            window.location.href = response.url;
                        } else {
                            // Fallback if no redirect (shouldn't happen with current backend)
                            window.location.href = `/infinite-wiki/world/Eternal-Library-Realms/wiki/${encodeURIComponent(cleanText)}`;
                        }
                    } catch (err) {
                        console.error("Generation failed:", err);
                        btn.innerHTML = 'Error';
                        setTimeout(() => {
                            btn.innerHTML = '<span class="icon">✨</span> Generate';
                            btn.disabled = false;
                        }, 2000);
                    }
                }
            }
        });

        // Add spin animation if not present
        if (!document.getElementById('spin-style')) {
            const style = document.createElement('style');
            style.id = 'spin-style';
            style.textContent = '@keyframes spin { to { transform: rotate(360deg); } }';
            document.head.appendChild(style);
        }
    });

    // Delegate event listener for red links (since they are dynamically inserted)
    document.addEventListener('click', async (e) => {
        if (e.target.matches('a.new-article')) {
            e.preventDefault();
            const title = e.target.dataset.title;
            const description = prompt(`Create new article: "${title}"?\n\nEnter optional instructions/context for the AI:`);

            if (description !== null) { // If not cancelled
                // Show loading on the link itself
                const originalText = e.target.innerText;
                e.target.innerText = "Creating...";
                e.target.style.pointerEvents = "none";

                // Submit to create_custom
                const formData = new FormData();
                formData.append('title', title);
                if (description) {
                    formData.append('description', description);
                }

                try {
                    const response = await fetch('/infinite-wiki/world/Eternal-Library-Realms/create_custom', {
                        method: 'POST',
                        body: formData
                    });

                    if (response.redirected) {
                        window.location.href = response.url;
                    } else {
                        window.location.href = `/infinite-wiki/world/Eternal-Library-Realms/wiki/${encodeURIComponent(title)}`;
                    }
                } catch (err) {
                    alert("Creation failed: " + err);
                    e.target.innerText = originalText;
                    e.target.style.pointerEvents = "auto";
                }
            }
        }
    });

    async function extractEvents() {
        if (!confirm("This will analyze the article to extract and graph historical events. Continue?")) return;

        const btn = document.querySelector('button[onclick="extractEvents()"]');
        const originalText = btn.innerText;
        btn.innerText = "Extracting...";
        btn.disabled = true;

        try {
            const response = await fetch('/infinite-wiki/world/Eternal-Library-Realms/wiki/Waves of Magic/extract_events', {
                method: 'POST'
            });

            if (response.redirected) {
                window.location.href = response.url;
            } else {
                window.location.reload();
            }
        } catch (err) {
            alert("Extraction failed: " + err);
            btn.innerText = originalText;
            btn.disabled = false;
        }
    }

    async function integrateInfo() {
        if (!confirm("This will rewrite the article to include new information from the knowledge base. Continue?")) return;

        const btn = document.querySelector('button[onclick="integrateInfo()"]');
        const originalText = btn.innerText;
        btn.innerText = "Integrating...";
        btn.disabled = true;

        try {
            const response = await fetch('/infinite-wiki/world/Eternal-Library-Realms/wiki/Waves of Magic/integrate', {
                method: 'POST'
            });

            if (response.redirected) {
                window.location.href = response.url;
            } else {
                window.location.reload();
            }
        } catch (err) {
            alert("Integration failed: " + err);
            btn.innerText = originalText;
            btn.disabled = false;
        }
    }
</script>

    </div>
    <script>
        function showLoading() {
            document.getElementById('loading-msg').style.display = 'block';
        }
    </script>
</body>

</html>